diff -ru ../libcaca.old/caca/caca.h ../libcaca/caca/caca.h
--- ../libcaca.old/caca/caca.h	Tue Dec 12 01:53:51 2006
+++ ./caca/caca.h	Fri Nov  2 15:16:33 2007
@@ -27,6 +27,13 @@
 /** libcaca API version */
 #define CACA_API_VERSION_1
 
+// Define LIBCACA_EXPORTS when caca is compiled into a DLL.
+#if defined(_WIN32) && defined(LIBCACA_EXPORTS)
+  #define CACA_EXPORT		__declspec(dllexport)
+#else
+  #define CACA_EXPORT
+#endif
+  
 #include <cucul.h>
 
 #ifdef __cplusplus
@@ -180,14 +187,14 @@
  *  initialisation, system information retrieval and configuration.
  *
  *  @{ */
-caca_display_t * caca_create_display(cucul_canvas_t *);
-int caca_free_display(caca_display_t *);
-int caca_refresh_display(caca_display_t *);
-int caca_set_display_time(caca_display_t *, unsigned int);
-unsigned int caca_get_display_time(caca_display_t *);
-unsigned int caca_get_display_width(caca_display_t *);
-unsigned int caca_get_display_height(caca_display_t *);
-int caca_set_display_title(caca_display_t *, char const *);
+CACA_EXPORT caca_display_t * caca_create_display(cucul_canvas_t *);
+CACA_EXPORT int caca_free_display(caca_display_t *);
+CACA_EXPORT int caca_refresh_display(caca_display_t *);
+CACA_EXPORT int caca_set_display_time(caca_display_t *, unsigned int);
+CACA_EXPORT unsigned int caca_get_display_time(caca_display_t *);
+CACA_EXPORT unsigned int caca_get_display_width(caca_display_t *);
+CACA_EXPORT unsigned int caca_get_display_height(caca_display_t *);
+CACA_EXPORT int caca_set_display_title(caca_display_t *, char const *);
 /*  @} */
 
 /** \defgroup event libcaca event handling
@@ -196,11 +203,11 @@
  *  clicks.
  *
  *  @{ */
-int caca_get_event(caca_display_t *, unsigned int, caca_event_t *, int);
-unsigned int caca_get_mouse_x(caca_display_t *);
-unsigned int caca_get_mouse_y(caca_display_t *);
-int caca_set_mouse(caca_display_t *, int);
-int caca_set_cursor(caca_display_t *, int);
+CACA_EXPORT int caca_get_event(caca_display_t *, unsigned int, caca_event_t *, int);
+CACA_EXPORT unsigned int caca_get_mouse_x(caca_display_t *);
+CACA_EXPORT unsigned int caca_get_mouse_y(caca_display_t *);
+CACA_EXPORT int caca_set_mouse(caca_display_t *, int);
+CACA_EXPORT int caca_set_cursor(caca_display_t *, int);
 /*  @} */
 
 #ifdef __cplusplus
diff -ru ../libcaca.old/cucul/cucul.h ../libcaca/cucul/cucul.h
--- ../libcaca.old/cucul/cucul.h	Tue Jul 17 20:46:19 2007
+++ ./cucul/cucul.h	Fri Nov  2 15:09:37 2007
@@ -27,6 +27,14 @@
 /** libcucul API version */
 #define CUCUL_API_VERSION_1
 
+
+// Define LIBCUCUL_EXPORTS when cucul is compiled into a DLL.
+#if defined(_WIN32) && defined(LIBCUCUL_EXPORTS)
+  #define CUCUL_EXPORT		__declspec(dllexport)
+#else
+  #define CUCUL_EXPORT
+#endif
+  
 #ifdef __cplusplus
 extern "C"
 {
@@ -75,12 +83,12 @@
  *  initialisation, system information retrieval and configuration.
  *
  *  @{ */
-cucul_canvas_t * cucul_create_canvas(unsigned int, unsigned int);
-int cucul_set_canvas_size(cucul_canvas_t *, unsigned int, unsigned int);
-unsigned int cucul_get_canvas_width(cucul_canvas_t *);
-unsigned int cucul_get_canvas_height(cucul_canvas_t *);
-int cucul_free_canvas(cucul_canvas_t *);
-int cucul_rand(int, int);
+CUCUL_EXPORT cucul_canvas_t * cucul_create_canvas(unsigned int, unsigned int);
+CUCUL_EXPORT int cucul_set_canvas_size(cucul_canvas_t *, unsigned int, unsigned int);
+CUCUL_EXPORT unsigned int cucul_get_canvas_width(cucul_canvas_t *);
+CUCUL_EXPORT unsigned int cucul_get_canvas_height(cucul_canvas_t *);
+CUCUL_EXPORT int cucul_free_canvas(cucul_canvas_t *);
+CUCUL_EXPORT int cucul_rand(int, int);
 /*  @} */
 
 /** \defgroup canvas libcucul canvas drawing
@@ -90,25 +98,25 @@
  *
  *  @{ */
 #define CUCUL_MAGIC_FULLWIDTH 0x000ffffe /**< Used to indicate that the previous character was a fullwidth glyph. */
-int cucul_gotoxy(cucul_canvas_t *, int, int);
-int cucul_get_cursor_x(cucul_canvas_t *);
-int cucul_get_cursor_y(cucul_canvas_t *);
-int cucul_put_char(cucul_canvas_t *, int, int, unsigned long int);
-unsigned long int cucul_get_char(cucul_canvas_t *, int, int);
-int cucul_put_str(cucul_canvas_t *, int, int, char const *);
-unsigned long int cucul_get_attr(cucul_canvas_t *, int, int);
-int cucul_set_attr(cucul_canvas_t *, unsigned long int);
-int cucul_put_attr(cucul_canvas_t *, int, int, unsigned long int);
-int cucul_set_color_ansi(cucul_canvas_t *, unsigned char, unsigned char);
-int cucul_set_color_argb(cucul_canvas_t *, unsigned int, unsigned int);
-int cucul_printf(cucul_canvas_t *, int, int, char const *, ...);
-int cucul_clear_canvas(cucul_canvas_t *);
-int cucul_set_canvas_handle(cucul_canvas_t *, int, int);
-int cucul_get_canvas_handle_x(cucul_canvas_t *);
-int cucul_get_canvas_handle_y(cucul_canvas_t *);
-int cucul_blit(cucul_canvas_t *, int, int, cucul_canvas_t const *,
+CUCUL_EXPORT int cucul_gotoxy(cucul_canvas_t *, int, int);
+CUCUL_EXPORT int cucul_get_cursor_x(cucul_canvas_t *);
+CUCUL_EXPORT int cucul_get_cursor_y(cucul_canvas_t *);
+CUCUL_EXPORT int cucul_put_char(cucul_canvas_t *, int, int, unsigned long int);
+CUCUL_EXPORT unsigned long int cucul_get_char(cucul_canvas_t *, int, int);
+CUCUL_EXPORT int cucul_put_str(cucul_canvas_t *, int, int, char const *);
+CUCUL_EXPORT unsigned long int cucul_get_attr(cucul_canvas_t *, int, int);
+CUCUL_EXPORT int cucul_set_attr(cucul_canvas_t *, unsigned long int);
+CUCUL_EXPORT int cucul_put_attr(cucul_canvas_t *, int, int, unsigned long int);
+CUCUL_EXPORT int cucul_set_color_ansi(cucul_canvas_t *, unsigned char, unsigned char);
+CUCUL_EXPORT int cucul_set_color_argb(cucul_canvas_t *, unsigned int, unsigned int);
+CUCUL_EXPORT int cucul_printf(cucul_canvas_t *, int, int, char const *, ...);
+CUCUL_EXPORT int cucul_clear_canvas(cucul_canvas_t *);
+CUCUL_EXPORT int cucul_set_canvas_handle(cucul_canvas_t *, int, int);
+CUCUL_EXPORT int cucul_get_canvas_handle_x(cucul_canvas_t *);
+CUCUL_EXPORT int cucul_get_canvas_handle_y(cucul_canvas_t *);
+CUCUL_EXPORT int cucul_blit(cucul_canvas_t *, int, int, cucul_canvas_t const *,
                cucul_canvas_t const *);
-int cucul_set_canvas_boundaries(cucul_canvas_t *, int, int,
+CUCUL_EXPORT int cucul_set_canvas_boundaries(cucul_canvas_t *, int, int,
                                 unsigned int, unsigned int);
 /*  @} */
 
@@ -117,14 +125,14 @@
  *  These functions perform horizontal and vertical canvas flipping.
  *
  *  @{ */
-int cucul_invert(cucul_canvas_t *);
-int cucul_flip(cucul_canvas_t *);
-int cucul_flop(cucul_canvas_t *);
-int cucul_rotate_180(cucul_canvas_t *);
-int cucul_rotate_left(cucul_canvas_t *);
-int cucul_rotate_right(cucul_canvas_t *);
-int cucul_stretch_left(cucul_canvas_t *);
-int cucul_stretch_right(cucul_canvas_t *);
+CUCUL_EXPORT int cucul_invert(cucul_canvas_t *);
+CUCUL_EXPORT int cucul_flip(cucul_canvas_t *);
+CUCUL_EXPORT int cucul_flop(cucul_canvas_t *);
+CUCUL_EXPORT int cucul_rotate_180(cucul_canvas_t *);
+CUCUL_EXPORT int cucul_rotate_left(cucul_canvas_t *);
+CUCUL_EXPORT int cucul_rotate_right(cucul_canvas_t *);
+CUCUL_EXPORT int cucul_stretch_left(cucul_canvas_t *);
+CUCUL_EXPORT int cucul_stretch_right(cucul_canvas_t *);
 /*  @} */
 
 /** \defgroup attributes libcucul attribute conversions
@@ -132,9 +140,9 @@
  *  These functions perform conversions between attribute values.
  *
  *  @{ */
-unsigned char cucul_attr_to_ansi(unsigned long int);
-unsigned char cucul_attr_to_ansi_fg(unsigned long int);
-unsigned char cucul_attr_to_ansi_bg(unsigned long int);
+CUCUL_EXPORT unsigned char cucul_attr_to_ansi(unsigned long int);
+CUCUL_EXPORT unsigned char cucul_attr_to_ansi_fg(unsigned long int);
+CUCUL_EXPORT unsigned char cucul_attr_to_ansi_bg(unsigned long int);
 /*  @} */
 
 /** \defgroup charset libcucul character set conversions
@@ -142,12 +150,12 @@
  *  These functions perform conversions between usual character sets.
  *
  *  @{ */
-unsigned long int cucul_utf8_to_utf32(char const *, unsigned int *);
-unsigned int cucul_utf32_to_utf8(char *, unsigned long int);
-unsigned char cucul_utf32_to_cp437(unsigned long int);
-unsigned long int cucul_cp437_to_utf32(unsigned char);
-char cucul_utf32_to_ascii(unsigned long int);
-int cucul_utf32_is_fullwidth(unsigned long int);
+CUCUL_EXPORT unsigned long int cucul_utf8_to_utf32(char const *, unsigned int *);
+CUCUL_EXPORT unsigned int cucul_utf32_to_utf8(char *, unsigned long int);
+CUCUL_EXPORT unsigned char cucul_utf32_to_cp437(unsigned long int);
+CUCUL_EXPORT unsigned long int cucul_cp437_to_utf32(unsigned char);
+CUCUL_EXPORT char cucul_utf32_to_ascii(unsigned long int);
+CUCUL_EXPORT int cucul_utf32_is_fullwidth(unsigned long int);
 /*  @} */
 
 /** \defgroup prim libcucul primitives drawing
@@ -156,27 +164,27 @@
  *  boxes, triangles and ellipses.
  *
  *  @{ */
-int cucul_draw_line(cucul_canvas_t *, int, int, int, int, unsigned long int);
-int cucul_draw_polyline(cucul_canvas_t *, int const x[], int const y[], int,
+CUCUL_EXPORT int cucul_draw_line(cucul_canvas_t *, int, int, int, int, unsigned long int);
+CUCUL_EXPORT int cucul_draw_polyline(cucul_canvas_t *, int const x[], int const y[], int,
                         unsigned long int);
-int cucul_draw_thin_line(cucul_canvas_t *, int, int, int, int);
-int cucul_draw_thin_polyline(cucul_canvas_t *, int const x[], int const y[],
+CUCUL_EXPORT int cucul_draw_thin_line(cucul_canvas_t *, int, int, int, int);
+CUCUL_EXPORT int cucul_draw_thin_polyline(cucul_canvas_t *, int const x[], int const y[],
                              int);
 
-int cucul_draw_circle(cucul_canvas_t *, int, int, int, unsigned long int);
-int cucul_draw_ellipse(cucul_canvas_t *, int, int, int, int, unsigned long int);
-int cucul_draw_thin_ellipse(cucul_canvas_t *, int, int, int, int);
-int cucul_fill_ellipse(cucul_canvas_t *, int, int, int, int, unsigned long int);
-
-int cucul_draw_box(cucul_canvas_t *, int, int, int, int, unsigned long int);
-int cucul_draw_thin_box(cucul_canvas_t *, int, int, int, int);
-int cucul_draw_cp437_box(cucul_canvas_t *, int, int, int, int);
-int cucul_fill_box(cucul_canvas_t *, int, int, int, int, unsigned long int);
+CUCUL_EXPORT int cucul_draw_circle(cucul_canvas_t *, int, int, int, unsigned long int);
+CUCUL_EXPORT int cucul_draw_ellipse(cucul_canvas_t *, int, int, int, int, unsigned long int);
+CUCUL_EXPORT int cucul_draw_thin_ellipse(cucul_canvas_t *, int, int, int, int);
+CUCUL_EXPORT int cucul_fill_ellipse(cucul_canvas_t *, int, int, int, int, unsigned long int);
+
+CUCUL_EXPORT int cucul_draw_box(cucul_canvas_t *, int, int, int, int, unsigned long int);
+CUCUL_EXPORT int cucul_draw_thin_box(cucul_canvas_t *, int, int, int, int);
+CUCUL_EXPORT int cucul_draw_cp437_box(cucul_canvas_t *, int, int, int, int);
+CUCUL_EXPORT int cucul_fill_box(cucul_canvas_t *, int, int, int, int, unsigned long int);
 
-int cucul_draw_triangle(cucul_canvas_t *, int, int, int, int, int, int,
+CUCUL_EXPORT int cucul_draw_triangle(cucul_canvas_t *, int, int, int, int, int, int,
                         unsigned long int);
-int cucul_draw_thin_triangle(cucul_canvas_t *, int, int, int, int, int, int);
-int cucul_fill_triangle(cucul_canvas_t *, int, int, int, int, int, int,
+CUCUL_EXPORT int cucul_draw_thin_triangle(cucul_canvas_t *, int, int, int, int, int, int);
+CUCUL_EXPORT int cucul_fill_triangle(cucul_canvas_t *, int, int, int, int, int, int,
                         unsigned long int);
 /*  @} */
 
@@ -186,12 +194,12 @@
  *  removal, copying etc.
  *
  *  @{ */
-unsigned int cucul_get_frame_count(cucul_canvas_t *);
-int cucul_set_frame(cucul_canvas_t *, unsigned int);
-char const *cucul_get_frame_name(cucul_canvas_t *);
-int cucul_set_frame_name(cucul_canvas_t *, char const *);
-int cucul_create_frame(cucul_canvas_t *, unsigned int);
-int cucul_free_frame(cucul_canvas_t *, unsigned int);
+CUCUL_EXPORT unsigned int cucul_get_frame_count(cucul_canvas_t *);
+CUCUL_EXPORT int cucul_set_frame(cucul_canvas_t *, unsigned int);
+CUCUL_EXPORT char const *cucul_get_frame_name(cucul_canvas_t *);
+CUCUL_EXPORT int cucul_set_frame_name(cucul_canvas_t *, char const *);
+CUCUL_EXPORT int cucul_create_frame(cucul_canvas_t *, unsigned int);
+CUCUL_EXPORT int cucul_free_frame(cucul_canvas_t *, unsigned int);
 /*  @} */
 
 /** \defgroup dither libcucul bitmap dithering
@@ -200,28 +208,28 @@
  *  rendering.
  *
  *  @{ */
-cucul_dither_t *cucul_create_dither(unsigned int, unsigned int,
+CUCUL_EXPORT cucul_dither_t *cucul_create_dither(unsigned int, unsigned int,
                                     unsigned int, unsigned int,
                                     unsigned long int, unsigned long int,
                                     unsigned long int, unsigned long int);
-int cucul_set_dither_palette(cucul_dither_t *,
+CUCUL_EXPORT int cucul_set_dither_palette(cucul_dither_t *,
                              unsigned int r[], unsigned int g[],
                              unsigned int b[], unsigned int a[]);
-int cucul_set_dither_brightness(cucul_dither_t *, float);
-int cucul_set_dither_gamma(cucul_dither_t *, float);
-int cucul_set_dither_contrast(cucul_dither_t *, float);
-int cucul_set_dither_invert(cucul_dither_t *, int);
-int cucul_set_dither_antialias(cucul_dither_t *, char const *);
-char const * const * cucul_get_dither_antialias_list(cucul_dither_t const *);
-int cucul_set_dither_color(cucul_dither_t *, char const *);
-char const * const * cucul_get_dither_color_list(cucul_dither_t const *);
-int cucul_set_dither_charset(cucul_dither_t *, char const *);
-char const * const * cucul_get_dither_charset_list(cucul_dither_t const *);
-int cucul_set_dither_mode(cucul_dither_t *, char const *);
-char const * const * cucul_get_dither_mode_list(cucul_dither_t const *);
-int cucul_dither_bitmap(cucul_canvas_t *, int, int, int, int,
+CUCUL_EXPORT int cucul_set_dither_brightness(cucul_dither_t *, float);
+CUCUL_EXPORT int cucul_set_dither_gamma(cucul_dither_t *, float);
+CUCUL_EXPORT int cucul_set_dither_contrast(cucul_dither_t *, float);
+CUCUL_EXPORT int cucul_set_dither_invert(cucul_dither_t *, int);
+CUCUL_EXPORT int cucul_set_dither_antialias(cucul_dither_t *, char const *);
+CUCUL_EXPORT char const * const * cucul_get_dither_antialias_list(cucul_dither_t const *);
+CUCUL_EXPORT int cucul_set_dither_color(cucul_dither_t *, char const *);
+CUCUL_EXPORT char const * const * cucul_get_dither_color_list(cucul_dither_t const *);
+CUCUL_EXPORT int cucul_set_dither_charset(cucul_dither_t *, char const *);
+CUCUL_EXPORT char const * const * cucul_get_dither_charset_list(cucul_dither_t const *);
+CUCUL_EXPORT int cucul_set_dither_mode(cucul_dither_t *, char const *);
+CUCUL_EXPORT char const * const * cucul_get_dither_mode_list(cucul_dither_t const *);
+CUCUL_EXPORT int cucul_dither_bitmap(cucul_canvas_t *, int, int, int, int,
                          cucul_dither_t const *, void *);
-int cucul_free_dither(cucul_dither_t *);
+CUCUL_EXPORT int cucul_free_dither(cucul_dither_t *);
 /*  @} */
 
 /** \defgroup font libcucul font handling
@@ -230,14 +238,14 @@
  *  canvas to bitmap rendering.
  *
  *  @{ */
-cucul_font_t *cucul_load_font(void const *, unsigned int);
-char const * const * cucul_get_font_list(void);
-unsigned int cucul_get_font_width(cucul_font_t *);
-unsigned int cucul_get_font_height(cucul_font_t *);
-unsigned long int const *cucul_get_font_blocks(cucul_font_t *);
-int cucul_render_canvas(cucul_canvas_t *, cucul_font_t *, void *,
+CUCUL_EXPORT cucul_font_t *cucul_load_font(void const *, unsigned int);
+CUCUL_EXPORT char const * const * cucul_get_font_list(void);
+CUCUL_EXPORT unsigned int cucul_get_font_width(cucul_font_t *);
+CUCUL_EXPORT unsigned int cucul_get_font_height(cucul_font_t *);
+CUCUL_EXPORT unsigned long int const *cucul_get_font_blocks(cucul_font_t *);
+CUCUL_EXPORT int cucul_render_canvas(cucul_canvas_t *, cucul_font_t *, void *,
                          unsigned int, unsigned int, unsigned int);
-int cucul_free_font(cucul_font_t *);
+CUCUL_EXPORT int cucul_free_font(cucul_font_t *);
 /*  @} */
 
 /** \defgroup importexport libcucul importers/exporters from/to various formats
@@ -246,12 +254,12 @@
  *  the current canvas to various text formats.
  *
  *  @{ */
-long int cucul_import_memory(cucul_canvas_t *, void const *,
+CUCUL_EXPORT long int cucul_import_memory(cucul_canvas_t *, void const *,
                              unsigned long int, char const *);
-long int cucul_import_file(cucul_canvas_t *, char const *, char const *);
-char const * const * cucul_get_import_list(void);
-void *cucul_export_memory(cucul_canvas_t *, char const *, unsigned long int *);
-char const * const * cucul_get_export_list(void);
+CUCUL_EXPORT long int cucul_import_file(cucul_canvas_t *, char const *, char const *);
+CUCUL_EXPORT char const * const * cucul_get_import_list(void);
+CUCUL_EXPORT void *cucul_export_memory(cucul_canvas_t *, char const *, unsigned long int *);
+CUCUL_EXPORT char const * const * cucul_get_export_list(void);
 /*  @} */
 
 #if !defined(_DOXYGEN_SKIP_ME)
diff -ru ../libcaca.old/cucul/cucul_internals.h ../libcaca/cucul/cucul_internals.h
--- ../libcaca.old/cucul/cucul_internals.h	Tue Dec 12 01:53:51 2006
+++ ../libcaca/cucul/cucul_internals.h	Fri Nov  2 15:29:06 2007
@@ -61,17 +61,17 @@
 };
 
 /* Canvas functions */
-extern int _cucul_set_canvas_size(cucul_canvas_t *, unsigned int, unsigned int);
+CUCUL_EXPORT extern int _cucul_set_canvas_size(cucul_canvas_t *, unsigned int, unsigned int);
 
 /* Colour functions */
-extern uint16_t _cucul_attr_to_rgb12fg(uint32_t);
-extern uint16_t _cucul_attr_to_rgb12bg(uint32_t);
-extern uint32_t _cucul_attr_to_rgb24fg(uint32_t);
-extern uint32_t _cucul_attr_to_rgb24bg(uint32_t);
-extern void _cucul_attr_to_argb4(uint32_t, uint8_t[8]);
+CUCUL_EXPORT extern uint16_t _cucul_attr_to_rgb12fg(uint32_t);
+CUCUL_EXPORT extern uint16_t _cucul_attr_to_rgb12bg(uint32_t);
+CUCUL_EXPORT extern uint32_t _cucul_attr_to_rgb24fg(uint32_t);
+CUCUL_EXPORT extern uint32_t _cucul_attr_to_rgb24bg(uint32_t);
+CUCUL_EXPORT extern void _cucul_attr_to_argb4(uint32_t, uint8_t[8]);
 
 /* Frames functions */
-extern void _cucul_save_frame_info(cucul_canvas_t *);
-extern void _cucul_load_frame_info(cucul_canvas_t *);
+CUCUL_EXPORT extern void _cucul_save_frame_info(cucul_canvas_t *);
+CUCUL_EXPORT extern void _cucul_load_frame_info(cucul_canvas_t *);
 
 #endif /* __CUCUL_INTERNALS_H__ */
